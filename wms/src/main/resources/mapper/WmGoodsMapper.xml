<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cyl.wms.mapper.WmGoodsMapper">

    <select id="selectListDetail" resultType="com.cyl.wms.pojo.vo.WmGoodsVO">

        SELECT
        go.*,
        supplier.supplier_name as supplierName
        from(
        SELECT
        goods.id,
        goods.goods_no AS goodsNo,
        goods.goods_name AS goodsName,
        goods.supplier_id AS supplierId,
        goodsUnit.spec_id AS specId,
        goodsUnit.spec_name AS specName,
        goods.goods_type_id AS goodsTypeId,
        goods.shelf_life AS shelfLife,
        goods.shelf_life_unit AS shelfLifeUnit,
        goods.remark,
        goodsUnit.unit_id AS unitId,
        unit.unit_name AS unitName,
        goodsUnit.sale_unit_price AS saleUnitPrice,
        goodsUnit.purchase_unit_price AS purchaseUnitPrice,
        goodsUnit.promo_unit_price AS promoUnitPrice
        FROM
        wm_goods as goods,
        wm_goods_detail as goodsUnit,
        wm_unit as unit
        WHERE
        goods.id = goodsUnit.goods_id
        AND
        goodsUnit.unit_id = unit.id
        <if test="query.goodsNo != null and query.goodsNo != ''">
            AND goods.goods_no = #{query.goodsNo}
        </if>
        <if test="query.goodsNameLike != null and query.goodsNameLike != ''">
            AND goods.goods_name LIKE CONCAT('%', #{query.goodsNameLike}, '%')
        </if>
        <if test="query.supplierId != null">
            AND goods.supplier_id = #{query.supplierId}
        </if>
        <if test="query.goodsTypeId != null">
            AND goods.goods_type_id = #{query.goodsTypeId}
        </if>
        <if test="query.shelfLife != null">
            AND goods.shelf_life = #{query.shelfLife}
        </if>
        <if test="query.shelfLifeUnit != null and query.shelfLifeUnit != ''">
            AND goods.shelf_life_unit = #{query.shelfLifeUnit}
        </if>
        ) as go

        left join wms_supplier as supplier on go.supplierId = supplier.id




    </select>
    <select id="selectListByGoodsIds" resultType="com.cyl.wms.pojo.vo.WmGoodsVO">
        SELECT
        go.*,
        supplier.supplier_name as supplierName
        from(
        SELECT
        goods.id,
        goods.goods_no AS goodsNo,
        goods.goods_name AS goodsName,
        goods.supplier_id AS supplierId,
        goodsUnit.spec_id AS specId,
        goodsUnit.spec_name AS specName,
        goods.goods_type_id AS goodsTypeId,
        goods.shelf_life AS shelfLife,
        goods.shelf_life_unit AS shelfLifeUnit,
        goods.remark,
        goodsUnit.unit_id AS unitId,
        unit.unit_name AS unitName,
        goodsUnit.sale_unit_price AS saleUnitPrice,
        goodsUnit.purchase_unit_price AS purchaseUnitPrice,
        goodsUnit.promo_unit_price AS promoUnitPrice
        FROM
        wm_goods as goods,
        wm_goods_detail as goodsUnit,
        wm_unit as unit
        WHERE
        goods.id = goodsUnit.goods_id
        AND
        goodsUnit.unit_id = unit.id
        AND goods.id IN
        <foreach collection="ids" item="id" open="(" separator="," close=")">
            #{id}
        </foreach>
        ) as go

        left join wms_supplier as supplier on go.supplierId = supplier.id
    </select>
</mapper>